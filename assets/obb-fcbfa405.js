import{g as f,Q as y,X as I,f as E,Y as V,L as g,W as k,S as L,d as G,P as N,J as R,j as U,M as A}from"./three.module-2e0eea6d.js";import{O as X}from"./OrbitControls-5ebfa66f.js";import{f as Y,h as D,g as J,y as Q,o as T,c as Z,_ as $}from"./index-4c8cf54e.js";const a={c:null,u:[new f,new f,new f],e:[]},r={c:null,u:[new f,new f,new f],e:[]},l=[[],[],[]],s=[[],[],[]],c=[],p=new f,w=new f,S=new f,h=new f,C=new f,O=new f,d=new y,q=new I,_=new E,F=new E,W=new V;class B{constructor(e=new f,i=new f,t=new y){this.center=e,this.halfSize=i,this.rotation=t}set(e,i,t){return this.center=e,this.halfSize=i,this.rotation=t,this}copy(e){return this.center.copy(e.center),this.halfSize.copy(e.halfSize),this.rotation.copy(e.rotation),this}clone(){return new this.constructor().copy(this)}getSize(e){return e.copy(this.halfSize).multiplyScalar(2)}clampPoint(e,i){const t=this.halfSize;h.subVectors(e,this.center),this.rotation.extractBasis(p,w,S),i.copy(this.center);const o=g.clamp(h.dot(p),-t.x,t.x);i.add(p.multiplyScalar(o));const n=g.clamp(h.dot(w),-t.y,t.y);i.add(w.multiplyScalar(n));const u=g.clamp(h.dot(S),-t.z,t.z);return i.add(S.multiplyScalar(u)),i}containsPoint(e){return h.subVectors(e,this.center),this.rotation.extractBasis(p,w,S),Math.abs(h.dot(p))<=this.halfSize.x&&Math.abs(h.dot(w))<=this.halfSize.y&&Math.abs(h.dot(S))<=this.halfSize.z}intersectsBox3(e){return this.intersectsOBB(K.fromBox3(e))}intersectsSphere(e){return this.clampPoint(e.center,O),O.distanceToSquared(e.center)<=e.radius*e.radius}intersectsOBB(e,i=Number.EPSILON){a.c=this.center,a.e[0]=this.halfSize.x,a.e[1]=this.halfSize.y,a.e[2]=this.halfSize.z,this.rotation.extractBasis(a.u[0],a.u[1],a.u[2]),r.c=e.center,r.e[0]=e.halfSize.x,r.e[1]=e.halfSize.y,r.e[2]=e.halfSize.z,e.rotation.extractBasis(r.u[0],r.u[1],r.u[2]);for(let n=0;n<3;n++)for(let u=0;u<3;u++)l[n][u]=a.u[n].dot(r.u[u]);h.subVectors(r.c,a.c),c[0]=h.dot(a.u[0]),c[1]=h.dot(a.u[1]),c[2]=h.dot(a.u[2]);for(let n=0;n<3;n++)for(let u=0;u<3;u++)s[n][u]=Math.abs(l[n][u])+i;let t,o;for(let n=0;n<3;n++)if(t=a.e[n],o=r.e[0]*s[n][0]+r.e[1]*s[n][1]+r.e[2]*s[n][2],Math.abs(c[n])>t+o)return!1;for(let n=0;n<3;n++)if(t=a.e[0]*s[0][n]+a.e[1]*s[1][n]+a.e[2]*s[2][n],o=r.e[n],Math.abs(c[0]*l[0][n]+c[1]*l[1][n]+c[2]*l[2][n])>t+o)return!1;return t=a.e[1]*s[2][0]+a.e[2]*s[1][0],o=r.e[1]*s[0][2]+r.e[2]*s[0][1],!(Math.abs(c[2]*l[1][0]-c[1]*l[2][0])>t+o||(t=a.e[1]*s[2][1]+a.e[2]*s[1][1],o=r.e[0]*s[0][2]+r.e[2]*s[0][0],Math.abs(c[2]*l[1][1]-c[1]*l[2][1])>t+o)||(t=a.e[1]*s[2][2]+a.e[2]*s[1][2],o=r.e[0]*s[0][1]+r.e[1]*s[0][0],Math.abs(c[2]*l[1][2]-c[1]*l[2][2])>t+o)||(t=a.e[0]*s[2][0]+a.e[2]*s[0][0],o=r.e[1]*s[1][2]+r.e[2]*s[1][1],Math.abs(c[0]*l[2][0]-c[2]*l[0][0])>t+o)||(t=a.e[0]*s[2][1]+a.e[2]*s[0][1],o=r.e[0]*s[1][2]+r.e[2]*s[1][0],Math.abs(c[0]*l[2][1]-c[2]*l[0][1])>t+o)||(t=a.e[0]*s[2][2]+a.e[2]*s[0][2],o=r.e[0]*s[1][1]+r.e[1]*s[1][0],Math.abs(c[0]*l[2][2]-c[2]*l[0][2])>t+o)||(t=a.e[0]*s[1][0]+a.e[1]*s[0][0],o=r.e[1]*s[2][2]+r.e[2]*s[2][1],Math.abs(c[1]*l[0][0]-c[0]*l[1][0])>t+o)||(t=a.e[0]*s[1][1]+a.e[1]*s[0][1],o=r.e[0]*s[2][2]+r.e[2]*s[2][0],Math.abs(c[1]*l[0][1]-c[0]*l[1][1])>t+o)||(t=a.e[0]*s[1][2]+a.e[1]*s[0][2],o=r.e[0]*s[2][1]+r.e[1]*s[2][0],Math.abs(c[1]*l[0][2]-c[0]*l[1][2])>t+o))}intersectsPlane(e){this.rotation.extractBasis(p,w,S);const i=this.halfSize.x*Math.abs(e.normal.dot(p))+this.halfSize.y*Math.abs(e.normal.dot(w))+this.halfSize.z*Math.abs(e.normal.dot(S)),t=e.normal.dot(this.center)-e.constant;return Math.abs(t)<=i}intersectRay(e,i){return this.getSize(C),q.setFromCenterAndSize(h.set(0,0,0),C),_.setFromMatrix3(this.rotation),_.setPosition(this.center),F.copy(_).invert(),W.copy(e).applyMatrix4(F),W.intersectBox(q,i)?i.applyMatrix4(_):null}intersectsRay(e){return this.intersectRay(e,h)!==null}fromBox3(e){return e.getCenter(this.center),e.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(e){return e.center.equals(this.center)&&e.halfSize.equals(this.halfSize)&&e.rotation.equals(this.rotation)}applyMatrix4(e){const i=e.elements;let t=h.set(i[0],i[1],i[2]).length();const o=h.set(i[4],i[5],i[6]).length(),n=h.set(i[8],i[9],i[10]).length();e.determinant()<0&&(t=-t),d.setFromMatrix4(e);const x=1/t,m=1/o,z=1/n;return d.elements[0]*=x,d.elements[1]*=x,d.elements[2]*=x,d.elements[3]*=m,d.elements[4]*=m,d.elements[5]*=m,d.elements[6]*=z,d.elements[7]*=z,d.elements[8]*=z,this.rotation.multiply(d),this.halfSize.x*=t,this.halfSize.y*=o,this.halfSize.z*=n,h.setFromMatrixPosition(e),this.center.add(h),this}}const K=new B,ee={id:"obb"},te=Y({__name:"obb",setup(j){let e=D(null);return J(()=>{const i=document.getElementById("obb"),t=new k({antialias:!0});t.setPixelRatio(window.devicePixelRatio),t.setSize(i.offsetWidth,i.offsetHeight),i.appendChild(t.domElement);const o=new L;o.background=new G(12575709);const n=new N(40,i.offsetWidth/i.offsetHeight,1,100);n.position.set(5,2,8);let u=new R,x=new U({color:16711680}),m=new A(u,x);o.add(m),m.position.x=2;let z=new B(m.position,new f(.5,.5,.5),new y),H=new R(3,1,1),b=new A(H,x);o.add(b),b.position.x=-2;let v=new B(b.position,new f(1.5,.5,.5),new y);const M=new X(n,t.domElement);M.target.set(0,.5,0),M.update(),M.enablePan=!1,M.enableDamping=!0,window.onresize=function(){n.aspect=i.offsetWidth/i.offsetHeight,n.updateProjectionMatrix(),t.setSize(i.offsetWidth,i.offsetHeight)};function P(){e.value=requestAnimationFrame(P),m.position.x-=.001,b.position.x+=.001,z.set(m.position,new f(.5,.5,.5),new y),v.set(b.position,new f(1.5,.5,.5),new y),z.intersectsOBB(v)?console.log("碰撞了"):console.log("没碰撞"),M.update(),t.render(o,n)}P()}),Q(()=>{console.log(11111111111),cancelAnimationFrame(e.value)}),(i,t)=>(T(),Z("div",ee))}});const ae=$(te,[["__scopeId","data-v-eebb1f1c"]]);export{ae as default};
