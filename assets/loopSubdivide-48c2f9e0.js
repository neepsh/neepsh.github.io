import{g as h,ap as E,B as V,W,s as k,k as R,S as I,d as C,P as O,aO as F,au as j,M}from"./three.module-2e0eea6d.js";import{O as H}from"./OrbitControls-5ebfa66f.js";import{R as N}from"./RoomEnvironment-c79c43e7.js";import{f as q,h as D,g as L,y as U,o as J,c as K,_ as Q}from"./index-4c8cf54e.js";function T(t){let o=t.clone().toNonIndexed(),n=o.getAttribute("position"),m=new Float32Array(n.count*3*4),a=new h,i=new h,r=new h,d=new h,c=new h,f=new h,s=0,u={},w={},p={};console.log(111111,o);for(let l=0;l<n.count;l+=3){a.fromBufferAttribute(n,l),i.fromBufferAttribute(n,l+1),r.fromBufferAttribute(n,l+2),d.addVectors(a,i).multiplyScalar(.5),c.addVectors(i,r).multiplyScalar(.5),f.addVectors(r,a).multiplyScalar(.5),B(m,s,a,d,f),s+=9,B(m,s,i,c,d),s+=9,B(m,s,r,f,c),s+=9,B(m,s,d,c,f),s+=9;let g=a.x+","+a.y+","+a.z,_=i.x+","+i.y+","+i.z,y=r.x+","+r.y+","+r.z,x=d.x+","+d.y+","+d.z,z=c.x+","+c.y+","+c.z,P=f.x+","+f.y+","+f.z;v(u,g,_,l+1),v(u,g,y,l+2),v(u,_,g,l+0),v(u,_,y,l+2),v(u,y,g,l+0),v(u,y,_,l+1),G(w,x,l+2),G(w,z,l),G(w,P,l+1),A(p,g,x),A(p,g,P),A(p,_,x),A(p,_,z),A(p,y,z),A(p,y,P)}let b=new E(m,3);return X(n,b,u,w)}function B(t,e,o,n,m){t[e+3*0]=o.x,t[e+3*1]=n.x,t[e+3*2]=m.x,t[e+1+3*0]=o.y,t[e+1+3*1]=n.y,t[e+1+3*2]=m.y,t[e+2+3*0]=o.z,t[e+2+3*1]=n.z,t[e+2+3*2]=m.z}function v(t,e,o,n){t[e]||(t[e]={}),t[e][o]||(t[e][o]=[]),t[e][o].push(n)}function G(t,e,o){t[e]||(t[e]=[]),t[e].push(o)}function A(t,e,o){t[e]||(t[e]=new Set),t[e].add(o)}function X(t,e,o,n,m){let a=[new h,new h,new h],i=new h;console.log(o,n),console.log(t);let r=new Float32Array(e.count*3),d=0;for(let f=0;f<e.count;f+=3){for(let s=0;s<3;s++){a[s].fromBufferAttribute(e,f+s);let u=a[s].x+","+a[s].y+","+a[s].z,w=o[u],p=n[u];if(w){const b=Object.keys(w).length,S=1/b*(5/8-Math.pow(3/8+1/4*Math.cos(2*Math.PI/b),2)),l=1-S*b;a[s].multiplyScalar(l);let g=new h;for(let _ in w){const y=w[_];i.set(0,0,0);for(let x=0;x<y.length;x++)i.add(g.fromBufferAttribute(t,y[x]));i.divideScalar(y.length),i.multiplyScalar(S),a[s].add(i)}}else if(p&&p.length===2){const b=p.length,S=.125,l=1-S*b;a[s].multiplyScalar(l),p.forEach(g=>{i.fromBufferAttribute(t,g),i.multiplyScalar(S),a[s].add(i)})}}B(r,d,a[0],a[1],a[2]),d+=9}let c=new V;return c.setAttribute("position",new E(r,3)),c.computeVertexNormals(),c}const Y={id:"robot"},Z=q({__name:"loopSubdivide",setup(t){let e=D(null);return L(()=>{const o=document.getElementById("robot"),n=new W({antialias:!0});n.setPixelRatio(window.devicePixelRatio),n.setSize(o.offsetWidth,o.offsetHeight),n.outputEncoding=k,o.appendChild(n.domElement);const m=new R(n),a=new I;a.background=new C(12575709),a.environment=m.fromScene(new N,.04).texture;const i=new O(40,o.offsetWidth/o.offsetHeight,1,100);i.position.set(5,2,8);const r=new H(i,n.domElement);r.target.set(0,.5,0),r.update(),r.enablePan=!1,r.enableDamping=!0;let d=new F(1,1,1),c=new j({color:16711935,roughness:.5,metalness:.5}),f=T(d),s=new M(f,c),u=new M(d,c);u.position.x=1,s.position.x=-1,a.add(u),a.add(s),w(),window.onresize=function(){i.aspect=o.offsetWidth/o.offsetHeight,i.updateProjectionMatrix(),n.setSize(o.offsetWidth,o.offsetHeight)};function w(){e.value=requestAnimationFrame(w),r.update(),n.render(a,i)}}),U(()=>{cancelAnimationFrame(e.value)}),(o,n)=>(J(),K("div",Y))}});const ne=Q(Z,[["__scopeId","data-v-f27da06f"]]);export{ne as default};
